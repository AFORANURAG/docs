"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[468],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=l(n),m=o,f=d["".concat(c,".").concat(m)]||d[m]||u[m]||a;return n?r.createElement(f,s(s({ref:t},p),{},{components:n})):r.createElement(f,s({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var l=2;l<a;l++)s[l]=n[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7190:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return c},default:function(){return m},frontMatter:function(){return i},metadata:function(){return l},toc:function(){return u}});var r=n(7462),o=n(3366),a=(n(7294),n(3905)),s=["components"],i={sidebar_position:4},c="Storage",l={unversionedId:"concepts/storage",id:"concepts/storage",title:"Storage",description:"Cyclic provides object storage backed by AWS S3. Each app is provisioned with an S3 bucket and allowed read/write access. Any AWS S3 compatible client will work.",source:"@site/docs/concepts/storage.md",sourceDirName:"concepts",slug:"/concepts/storage",permalink:"/docs/concepts/storage",draft:!1,editUrl:"https://github.com/cyclic-software/docs/edit/main/website/docs/concepts/storage.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Databases",permalink:"/docs/concepts/database"},next:{title:"Transactions",permalink:"/docs/concepts/transactions"}},p={},u=[{value:"Config",id:"config",level:2},{value:"Cost and Limits",id:"cost-and-limits",level:2},{value:"Install",id:"install",level:2},{value:"Usage in Express",id:"usage-in-express",level:2}],d={toc:u};function m(e){var t=e.components,n=(0,o.Z)(e,s);return(0,a.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"storage"},"Storage"),(0,a.kt)("p",null,"Cyclic provides object storage backed by AWS S3. Each app is provisioned with an S3 bucket and allowed read/write access. Any AWS S3 compatible client will work."),(0,a.kt)("h2",{id:"config"},"Config"),(0,a.kt)("p",null,"Apps running on Cyclic have environment AWS environment variables that provide for access to the app's associated S3 bucket. However, you will need to provide either a ",(0,a.kt)("inlineCode",{parentName:"p"},"BUCKET")," environment variable or set the bucket name directly in your code."),(0,a.kt)("p",null,"To access the bucket from local, go to the storage tab of the app, copy credentials and paste on your associated command line. As with running on Cyclic you will need to provide your code or cli the bucket name."),(0,a.kt)("h2",{id:"cost-and-limits"},"Cost and Limits"),(0,a.kt)("p",null,"The free tier includes:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"1GB of storage per month. Additional storage is billed on a GB / month basis."),(0,a.kt)("li",{parentName:"ul"},"10GB of data transfer to the internet per month. Additional data transfer is billed on a per GB basis.")),(0,a.kt)("p",null,"For a complete list of limits check out the ",(0,a.kt)("a",{parentName:"p",href:"/docs/overview/limits"},"limits page")),(0,a.kt)("h1",{id:"example"},"Example"),(0,a.kt)("h2",{id:"install"},"Install"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"npm install aws-sdk")),(0,a.kt)("h2",{id:"usage-in-express"},"Usage in Express"),(0,a.kt)("p",null,"From our ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/cyclic-software/starter-s3-storage"},"S3 Storage Starter")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const express = require('express')\nconst app = express()\nconst AWS = require(\"aws-sdk\");\nconst s3 = new AWS.S3()\nconst bodyParser = require('body-parser');\n\napp.use(bodyParser.json())\n\n// curl -i https://some-app.cyclic.app/myFile.txt\napp.get('*', async (req,res) => {\n  let filename = req.path.slice(1)\n\n  try {\n    let s3File = await s3.getObject({\n      Bucket: process.env.BUCKET,\n      Key: filename,\n    }).promise()\n\n    res.set('Content-type', s3File.ContentType)\n    res.send(s3File.Body.toString()).end()\n  } catch (error) {\n    if (error.code === 'NoSuchKey') {\n      console.log(`No such key ${filename}`)\n      res.sendStatus(404).end()\n    } else {\n      console.log(error)\n      res.sendStatus(500).end()\n    }\n  }\n})\n\n\n// curl -i -XPUT --data '{\"k1\":\"value 1\", \"k2\": \"value 2\"}' -H 'Content-type: application/json' https://some-app.cyclic.app/myFile.txt\napp.put('*', async (req,res) => {\n  let filename = req.path.slice(1)\n\n  console.log(typeof req.body)\n\n  await s3.putObject({\n    Body: JSON.stringify(req.body),\n    Bucket: process.env.BUCKET,\n    Key: filename,\n  }).promise()\n\n  res.set('Content-type', 'text/plain')\n  res.send('ok').end()\n})\n\n// curl -i -XDELETE https://some-app.cyclic.app/myFile.txt\napp.delete('*', async (req,res) => {\n  let filename = req.path.slice(1)\n\n  await s3.deleteObject({\n    Bucket: process.env.BUCKET,\n    Key: filename,\n  }).promise()\n\n  res.set('Content-type', 'text/plain')\n  res.send('ok').end()\n})\n\n// /////////////////////////////////////////////////////////////////////////////\n// Catch all handler for all other request.\napp.use('*', (req,res) => {\n  res.sendStatus(404).end()\n})\n\n// /////////////////////////////////////////////////////////////////////////////\n// Start the server\nconst port = process.env.PORT || 3000\napp.listen(port, () => {\n  console.log(`index.js listening at http://localhost:${port}`)\n})\n")))}m.isMDXComponent=!0}}]);